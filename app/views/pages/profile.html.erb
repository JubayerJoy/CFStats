<head>
    <!-- Bootstrap CSS -->
</head>

<body class = "background centered">

	<br/>
	<br/>

	<% handle = "" %>

	<% for user in UserSetting.where(username: current_user.username) %>	
		<div id = "<%= user.handle %>">
			<h4>
			<a target='_blank' href='http://codeforces.com/profile/<%= user.handle %>'>
				<%= handle = user.handle %>
			</a>
			</h4>
		</div>
	<% end %>

	<% if UserSetting.where(username: current_user.username).length == 0 %>
		<h3>This is your first login, welcome!</h3>
		<br/>
		<h3>Please insert your Codeforces handle below:</h3>
		<br/>
		<input type="text" id="update_handle_form" placeholder="Update Codeforces handle">
		<br/>
		<div id = "handles_notice"></div>

		<br/>
		<div id = "handles">
			<% for user in UserSetting.where(username: current_user.username) %>	
				<div id = "<%= user.handle %>">
					<a target='_blank' href='http://codeforces.com/profile/<%= user.handle %>'>
						<%= handle %>
					</a>
				</div>
			<% end %>
		</div>
		<i>Don't worry! You can change your handle later...</i>

	<% else %>
	

		<% if user_signed_in? %>
			<h4>Hello, <%= current_user.username %>! Your current saved CF handle is:</h4> 
		<% end %>

		<div id = "handles">
		</div>

		<input type="text" id="update_handle_form" placeholder="Update Codeforces handle">

		<br/>
		<div id = "handles_notice"><br/></div>

		<br/>

		<br/>
		<h3>Friends</h3>

		<input type="text" id="add_friends_form" placeholder="Add friend">
		<%= text_field_tag :search11, nil, placeholder: "Search friend", onkeyup: "filter('11', 'friends')" %>

		<br/>
		<div id = "friends_notice"><br/></div>
		
		<br/>
		<div id = "friends" class="border" style="margin: 0 auto; background-color: #ddffff; height: 18vh; width: 35vw; overflow: auto;">
			<% for user in UserSetting.where(username: current_user.username) %>
				<% for friend in user.friends %>
					<div id = "<%= friend %>">
						<a target='_blank' href='http://codeforces.com/profile/<%= friend %>'>
							<%= friend %>
						</a>
						&nbsp;
						<%= image_tag("compare.png", size: "16x16", onclick: "compare('#{handle}', '#{friend}')") %>
						<%= image_tag("cancel.png", size: "16x16", onclick: "try_remove_friend('#{friend}')") %>
					</div>
				<% end %>
			<% end %>
		</div>

		<br/>
		<br/>
		<br/>


		<div class="container">

			<div class="fiftyLEFT">
				<h3>Problems</h3>
				<input type="text" id="add_links_form" placeholder="Add problem URL"> 
				<%= text_field_tag :search12, nil, placeholder: "Search problem", onkeyup: "filter('12', 'links')" %>
				<br/>
				<div id = "links_notice"><br/></div>
				<br/>
				<div id = "links" class="border" style="background-color: #ddffff; height: 30vh; overflow: auto;">
					<% for user in UserSetting.where(username: current_user.username) %>
						<% for link in user.settings %>
							<div id = "<%= link %>">
								<div>
								<% if @problems_solved.key?(link) %>
									<i>(solved)</i>
								<% end %>
								<a target='_blank' href='http://codeforces.com/contest/<%= link[0, link.length-1] %>/problem/<%= link[link.length-1] %>'>
									<%= link %>
								</a>
								<%= image_tag("cancel.png", size: "16x16", onclick: "try_remove_link('#{link}')") %>
								</div>
							</div>
						<% end %>
					<% end %>
				</div>
				<br/>
				<br/>
				<br/>
				<br/>
			</div>


			<div class="fiftyRIGHT">
				<h3> Contests </h3>
				<input type="text" id="add_contests_form" placeholder="Add contest URL"> 
				<%= text_field_tag :search13, nil, placeholder: "Search contest", onkeyup: "filter('13', 'contests')" %>
				<br/>
				<div id = "contests_notice"><br/></div>
				<br/>
				<div id = "contests" class="border" style="background-color: #ddffff; height: 30vh; overflow: auto;">
					<% for user in UserSetting.where(username: current_user.username) %>
						<% for contest in user.contests %>
							<div id = "<%= contest %>">
								<% if @contests_attempted.key?(contest) %>
									<i>(attempted)</i>
								<% end %>
								<% base = "" %>
								<% if contest.to_i > 99999 %>
									<% base = "gym" %>
								<% else %>
									<% base = "contest" %>
								<% end %>
								<a target='_blank' href='http://codeforces.com/<%= base %>/<%= contest %>'>
									<%= contest %>
								</a>
								<%= image_tag("cancel.png", size: "16x16", onclick: "try_remove_contest('#{contest}')") %>
							</div>
						<% end %>
					<% end %>
				</div>
				<br/>
				<br/>
				<br/>
				<br/>
			</div>

		</div>
	<% end %>

</body>